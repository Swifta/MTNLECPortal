<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core"  xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:body>


        <div id="canvas">
            <div style="text-align: right;padding: 5px;" class="elevens">
                <h:form>
                    <p:commandButton value="Log Out" styleClass="elevens bolds" action="#{portalAdminBean.logOut()}" ajax="false"/>
                </h:form>
            </div>
            <p:tabView styleClass="elevens bolds" dynamic="true" activeIndex="#{schoolBean.activeIndex}">
                <p:ajax event="tabChange" listener="#{schoolBean.onTabChange}"/>   
                <p:tab title="Manage Exchange Rate" id="manageschool">
                    <p:dialog header="Add New Exchange Rate" widgetVar="school" styleClass="elevens bolds" width="450" resizable="false" modal="true">
                        <h:form>
                            <h:panelGrid styleClass="elevens" columns="2" style="width : 90%;margin: 0 auto">

                                <h:outputLabel value="1 USD  = "/>

                                <h:inputText value="#{schoolBean.exchangeRate.lsdRate}" styleClass="elevens padded" size="35" required="true" requiredMessage="Exchange rate required" validatorMessage="Validation Error: Ensure the exchange rate contains just valid numbers.">
                                 LSD   <f:validateRegex pattern="^\d+(\.\d+)?$" />
                                </h:inputText>
                                <h:commandButton   value="Create Rate" styleClass="buttons elevens whites bolds padded" style="color : #fff;" action="#{schoolBean.createExchangeRate()}"/> 
                            </h:panelGrid>                    
                        </h:form>
                    </p:dialog>
                    <div style="text-align: right;padding: 5px;" class="elevens">
                        <h:form>
                            <p:commandButton value="Add Exchange Rate" styleClass="elevens bolds" onclick="school.show();" style="display:#{portalAdminBean.editable}"/>
                            <p:spacer width="20"/>
                        </h:form>
                    </div>
                    <br />
                    <h:form>
                        <h:panelGrid styleClass="elevens bolds" columns="7" style="width : 90%;margin: 0 auto">
                            <h:outputLabel value=""/>
                            <h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto"> 
                                <h:outputLabel value="Enter the date the exchange rate was created"/>
                                <p:calendar value="#{schoolBean.exchangeRateDate}" id="exchangeRateDate" pattern="yyyy-MM-dd" /> 
                            </h:panelGrid>
                        </h:panelGrid>

                        <div style="text-align: center;padding: 5px;" class="elevens">

                            <p:commandButton value="Search" actionListener="#{schoolBean.searchExchangeRates()}" styleClass="elevens bolds" ajax="false"/>

                        </div>
                        <h:panelGrid columns="2" styleClass="elevens bolds">  
                            <p:panel header="Export All Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="schools" fileName="#{schoolBean.exchangeRatesFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="schools" fileName="#{schoolBean.exchangeRatesFileName}"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="schools" fileName="#{schoolBean.exchangeRatesFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="schools" fileName="#{schoolBean.exchangeRatesFileName}" />  
                                </h:commandLink>  
                            </p:panel>  

                            <p:panel header="Export Page Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="schools" fileName="#{schoolBean.exchangeRatesFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="schools" fileName="#{schoolBean.exchangeRatesFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="schools" fileName="#{schoolBean.exchangeRatesFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="schools" fileName="#{schoolBean.exchangeRatesFileName}" pageOnly="true"/>  
                                </h:commandLink>  
                            </p:panel>  
                        </h:panelGrid><p:dataTable paginator="true" rows="20"  
                                                   paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                                   rowsPerPageTemplate="5,10,15" styleClass="elevens datatables" value="#{schoolBean.allExchange}" var="allExchange" id="exchangetable">
                            <f:facet name="header">List of Exchange Rates</f:facet>
                            <p:column headerText=" 1 USD equivalence in LSD" sortBy="#{allExchange.lsdRate}">
                                <h:outputLabel value="#{allExchange.lsdRate}"/>
                            </p:column><p:column headerText=" Date of Exchange Rate " sortBy="#{allExchange.datecreated}">
                                <h:outputLabel value="#{allExchange.datecreated}"/>
                            </p:column>
                            <p:column>  
                                <p:commandLink action="#{schoolBean.retrieveSchool(schools.id)}" style="display:#{portalAdminBean.editable};">
                                    <h:graphicImage  value="images/edit.png" /></p:commandLink>  
                            </p:column>                   
                        </p:dataTable></h:form></p:tab>
                 <p:tab title="Manage Minimum Rate" id="manageminrate">
                    <p:dialog header="Add New Minimum Rate" widgetVar="minimumrate" styleClass="elevens bolds" width="450" resizable="false" modal="true">
                        <h:form>
                            <h:panelGrid styleClass="elevens" columns="2" style="width : 90%;margin: 0 auto">

                                <h:inputText value="#{schoolBean.minimumRate.amount}" styleClass="elevens padded" size="35" required="true" requiredMessage="Exchange rate required" validatorMessage="Validation Error: Ensure the exchange rate contains just valid numbers.">
                                 LSD   <f:validateRegex pattern="^\d+(\.\d+)?$" />
                                </h:inputText>
                                <h:commandButton   value="Create Minimum Rate" styleClass="buttons elevens whites bolds padded" style="color : #fff;" action="#{schoolBean.createMinimumRate()}"/> 
                            </h:panelGrid>                    
                        </h:form>
                    </p:dialog>
                    <div style="text-align: right;padding: 5px;" class="elevens">
                        <h:form>
                            <p:commandButton value="Add Minimum Rate" styleClass="elevens bolds" onclick="minimumrate.show();" style="display:#{portalAdminBean.editable}"/>
                            <p:spacer width="20"/>
                        </h:form>
                    </div>
                    <br />
                    <h:form>
                        <h:panelGrid styleClass="elevens bolds" columns="7" style="width : 90%;margin: 0 auto">
                            <h:outputLabel value=""/>
                            <h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto"> 
                                <h:outputLabel value="Enter the date the minimum rate was created"/>
                                <p:calendar value="#{schoolBean.minimumRateDate}" id="minimumRateDate" pattern="yyyy-MM-dd" /> 
                                </h:panelGrid>
                        </h:panelGrid>

                        <div style="text-align: center;padding: 5px;" class="elevens">

                            <p:commandButton value="Search" actionListener="#{schoolBean.searchMinimumRates()}" styleClass="elevens bolds" ajax="false"/>

                        </div>
                        <h:panelGrid columns="2" styleClass="elevens bolds">  
                            <p:panel header="Export All Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="schools" fileName="#{schoolBean.minimumRatesFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="schools" fileName="#{schoolBean.minimumRatesFileName}"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="schools" fileName="#{schoolBean.minimumRatesFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="schools" fileName="#{schoolBean.minimumRatesFileName}" />  
                                </h:commandLink>  
                            </p:panel>  

                            <p:panel header="Export Page Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="schools" fileName="#{schoolBean.minimumRatesFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="schools" fileName="#{schoolBean.minimumRatesFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="schools" fileName="#{schoolBean.minimumRatesFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="schools" fileName="#{schoolBean.minimumRatesFileName}" pageOnly="true"/>  
                                </h:commandLink>  
                            </p:panel>  
                        </h:panelGrid><p:dataTable paginator="true" rows="20"  
                                                   paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                                   rowsPerPageTemplate="5,10,15" styleClass="elevens datatables" value="#{schoolBean.allMinimumRates}" var="allMinimumRates" id="exchangetable">
                            <f:facet name="header">List of Minimum Rates</f:facet>
                            <p:column headerText=" Minimum rate in LSD" sortBy="#{allMinimumRates.amount}">
                                <h:outputLabel value="#{allMinimumRates.amount}"/>
                            </p:column><p:column headerText=" Date of Minimum Rate " sortBy="#{allMinimumRates.datecreated}">
                                <h:outputLabel value="#{allMinimumRates.datecreated}"/>
                            </p:column>
                            <p:column>  
                                <p:commandLink action="#{schoolBean.retrieveSchool(schools.id)}" style="display:#{portalAdminBean.editable};">
                                    <h:graphicImage  value="images/edit.png" /></p:commandLink>  
                            </p:column>                   
                        </p:dataTable></h:form></p:tab>
                
                <p:tab title="Manage Portal Admins" id="manageportaladmin">
                    <p:dialog header="Add New Portal Admin" widgetVar="portalAdmin" styleClass="elevens bolds" width="450" resizable="false" modal="true">
                        <h:form>
                            <h:panelGrid styleClass="elevens" columns="2" style="width : 90%;margin: 0 auto">

                                <h:outputLabel value="Admin Username : "/>
                                <h:inputText value="#{schoolBean.portalAdmin.username}" styleClass="elevens padded" size="35" required="true" requiredMessage="Administrator Name required" validatorMessage="Validation Error: Ensure the portal admin's name doesn't contain special characters, space and is between 4 to 50-character lenght">
                                    <f:validateRegex pattern="^[^-!@~#$%/\\|][\w\s]{3,50}$" />
                                </h:inputText>
                                <h:outputLabel value="Password : "/>
                                <h:inputText value="#{schoolBean.portalAdmin.password}" styleClass="elevens padded" size="35" required="true" requiredMessage="Admin password required" validatorMessage="Validation Error: Ensure the portal administrator's password doesn't contain special characters, space and is between 6 to 20-character lenght">
                                    <f:validateRegex pattern="^[^-!@~#$%/\\|][\w\s]{5,20}" />
                                </h:inputText>
                                <h:outputLabel value="Pick a role"/>
                                <h:selectOneMenu styleClass="elevens padded" value="#{schoolBean.portalAdmin.roleId}">
                                    <f:selectItems value="#{portalAdminBean.adminRoles}" var="adminRole" itemLabel="#{adminRole.name}" itemValue="#{adminRole.id}"/> 
                                </h:selectOneMenu>
                                <h:outputLabel value=""/>
                                <h:commandButton   value="Create Portal Admin" styleClass="buttons elevens whites bolds padded" style="color : #fff;" action="#{schoolBean.createPortalAdmin()}"/> 
                            </h:panelGrid>                    
                        </h:form>
                    </p:dialog>
                    <div style="text-align: right;padding: 5px;" class="elevens">
                        <h:form>
                            <p:commandButton value="Add Portal Admin" styleClass="elevens bolds" onclick="portalAdmin.show();" style="display:#{portalAdminBean.editable}"/>
                            <p:spacer width="20"/>
                        </h:form>
                    </div>
                    <br />
                    <h:form><h:panelGrid styleClass="elevens bolds" columns="7" style="width : 90%;margin: 0 auto">
                            <h:outputLabel value=""/>
                            <h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto"> 
                                <h:outputLabel value="Entter the username of the admin as a search parameter"/>
                                <h:inputText value="#{portalAdminBean.searchParameter}" styleClass="elevens padded" size="35" validatorMessage="Validation Error: Ensure the search parameter doesn't contain special characters and space.">
                                    <f:validateRegex pattern="^[^-!@~#$%/\\|][\w\s]{0,34}$" />
                                </h:inputText>
                            </h:panelGrid>
                        </h:panelGrid>

                        <div style="text-align: center;padding: 5px;" class="elevens">

                            <p:commandButton value="Search" actionListener="#{portalAdminBean.searchPortalAdmin()}" styleClass="elevens bolds" ajax="false"/>

                        </div>
                        <h:panelGrid columns="2" styleClass="elevens bolds">  
                            <p:panel header="Export All Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="adminList" fileName="#{schoolBean.adminListFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="adminList" fileName="#{schoolBean.adminListFileName}"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="adminList" fileName="#{schoolBean.adminListFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="adminList" fileName="#{schoolBean.adminListFileName}" />  
                                </h:commandLink>  
                            </p:panel>  

                            <p:panel header="Export Page Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="adminList" fileName="#{schoolBean.adminListFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="adminList" fileName="#{schoolBean.adminListFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="adminList" fileName="#{schoolBean.adminListFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="adminList" fileName="#{schoolBean.adminListFileName}" pageOnly="true"/>  
                                </h:commandLink>  
                            </p:panel>  
                        </h:panelGrid> <p:dataTable paginator="true" rows="20" id="adminList"
                                                    paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                                    rowsPerPageTemplate="5,10,15" styleClass="elevens datatables" value="#{portalAdminBean.portalAdmins}" var="portalAdmins" >
                            <f:facet name="header">List of Portal Admins</f:facet>
                            <p:column headerText="Admin Username" sortBy="#{portalAdmins.username}">
                                <h:outputLabel value="#{portalAdmins.username}"/>
                            </p:column><p:column headerText="Admin Role" sortBy="#{portalAdmins.roleName}">
                                <h:outputLabel value="#{portalAdmins.roleName}"/>
                            </p:column>
                            <p:column>  
                                <h:panelGrid styleClass="elevens companyHeaderGrid" columns="5">
                                    <p:commandLink action="#{schoolBean.retrievePortalAdmin(portalAdmins.id)}" style="display:#{portalAdminBean.editable}"> 
                                        <h:graphicImage  value="images/edit.png" /> </p:commandLink> 
                                    <h:outputLabel value="|" style="width:100%" />
                                    <p:commandLink action="#{schoolBean.deletePortalAdmin(portalAdmins.id)}" update="adminList" ajax="true" style="display:#{portalAdminBean.editable}"> 
                                        <h:graphicImage  value="images/delete.png" />
                                    </p:commandLink>
                                </h:panelGrid>
                            </p:column>                   
                        </p:dataTable></h:form></p:tab>
                <p:tab title="Transaction History" id="transhist"> 
                    <h:form>
                        <div style="text-align: center;padding: 5px;" class="elevens"> 
                            <h:outputLabel value="#{schoolBean.subTotal}" />
                        </div>             


                        <h:panelGrid styleClass="elevens bolds" columns="7" style="width : 90%;margin: 0 auto">
                            <h:outputLabel value=""/><h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto"> <h:outputLabel value="From:"/>
                                <p:calendar value="#{schoolBean.txnFirstDate}" id="fromDate" pattern="yyyy-MM-dd" /> 
                            </h:panelGrid><h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto">
                                <h:outputLabel value="To:"/>
                                <p:calendar value="#{schoolBean.txnSecondDate}" id="toDate" pattern="yyyy-MM-dd"/> 
                            </h:panelGrid>
                        </h:panelGrid>

                        <div style="text-align: center;padding: 5px;" class="elevens">

                            <p:commandButton value="Search" actionListener="#{schoolBean.retrieveTransacionHistoryModel()}" styleClass="elevens bolds" ajax="false"/>

                        </div>
                        <h:panelGrid columns="2" styleClass="elevens bolds">  
                            <p:panel header="Export All Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="txnHistory" fileName="#{schoolBean.transactionHistoryFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="txnHistory" fileName="#{schoolBean.transactionHistoryFileName}"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="txnHistory" fileName="#{schoolBean.transactionHistoryFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="txnHistory" fileName="#{schoolBean.transactionHistoryFileName}" />  
                                </h:commandLink>  
                            </p:panel>  

                            <p:panel header="Export Page Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="txnHistory" fileName="#{schoolBean.transactionHistoryFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="txnHistory" fileName="#{schoolBean.transactionHistoryFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="txnHistory" fileName="#{schoolBean.transactionHistoryFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="txnHistory" fileName="#{schoolBean.transactionHistoryFileName}" pageOnly="true"/>  
                                </h:commandLink>  
                            </p:panel>  
                        </h:panelGrid> 
                        <div style="text-align: right;padding: 5px;" class="elevens">
                            <p:commandButton value="Redeem" styleClass="elevens bolds" actionListener="#{schoolBean.redeemSelectedtransactions()}" ajax="false" style="display:#{portalAdminBean.editable}"/>
                        </div>
                        <p:dataTable rows="20" paginator="true" selection="#{schoolBean.selectedTransactionHistories}" styleClass="elevens datatables" value="#{schoolBean.transacionHistoryDataModel}" var="history" id="txnHistory">
                            <f:facet name="header">Transaction History</f:facet>
                            <p:column selectionMode="multiple" exportable="false" /> 
                            <p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Name of Student" />  
                                </f:facet>  
                                <h:outputText value="#{history.studentName}" />  
                            </p:column><p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Amount Paid" />  
                                </f:facet>  
                                <h:outputText value="#{history.amountPaid}" />  
                            </p:column><p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Paid By" />  
                                </f:facet>  
                                <h:outputText value="#{history.paidBy}" />  
                            </p:column><p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Payment Reference" />  
                                </f:facet>  
                                <h:outputText value="#{history.paymentRef}" />  
                            </p:column><p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Fundamo Transaction ID" />  
                                </f:facet>  
                                <h:outputText value="#{history.transactionID}" />  
                            </p:column>
                            <p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Date" />  
                                </f:facet>  
                                <h:outputText value="#{history.date}" />  
                            </p:column>

                            <p:column headerText="Redeem" exportable="false" > 
                                <p:commandLink rendered="#{history.redeemed == false}" actionListener="#{schoolBean.redeemTransaction(history.id)}" ajax="false" style="display:#{portalAdminBean.editable}"> 
                                    <h:graphicImage  value="/images/page_tick.gif" /> 
                                </p:commandLink>  
                                <h:graphicImage rendered="#{history.redeemed == true}" value="images/icon_accept.gif" />
                            </p:column> 
                        </p:dataTable>                    
                    </h:form>
                </p:tab>      
                <p:tab title="Audit Trail" id="audittrail">       
                    <h:form><h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto">
                            <h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto"> <h:outputLabel value="From:"/>
                                <p:calendar value="#{schoolBean.firstDate}" id="fromDate" pattern="yyyy-MM-dd" /> 
                            </h:panelGrid><h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto">
                                <h:outputLabel value="To:"/>
                                <p:calendar value="#{schoolBean.secondDate}" id="toDate" pattern="yyyy-MM-dd"/> 
                            </h:panelGrid>
                        </h:panelGrid>
                        <br/>
                        <h:panelGrid styleClass="elevens bolds" columns="2" style="width : 90%;margin: 0 auto">
                            <p:fieldset legend="Group" styleClass="fifteens bolds centers">
                                <p:selectManyCheckbox value="#{schoolBean.selectedActionTypes}">  
                                    <f:selectItem itemLabel="School Admin" itemValue="SchoolAdmin" />  
                                    <f:selectItem itemLabel="Admin" itemValue="Admin" />  
                                </p:selectManyCheckbox> </p:fieldset>
                            <p:fieldset legend="Actions" styleClass="fifteens bolds centers evenspacing"> <p:selectManyCheckbox  value="#{schoolBean.selectedActionsPerformed}">  
                                    <f:selectItem itemLabel="Create" itemValue="Create" />  
                                    <f:selectItem itemLabel="Update" itemValue="Update" />  
                                    <f:selectItem itemLabel="Delete" itemValue="Delete" />    
                                </p:selectManyCheckbox> 
                            </p:fieldset>
                            <br/>
                            <br/>
                            <div style="text-align: right;padding: 5px;" class="elevens">
                                <h:form>
                                    <p:commandButton value="Search" styleClass="elevens bolds" action="#{schoolBean.retrieveAuditTrail()}" ajax="false"/>
                                </h:form>
                            </div>

                        </h:panelGrid>
                        <h:panelGrid columns="2" styleClass="elevens bolds">  
                            <p:panel header="Export All Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="audittrails" fileName="#{schoolBean.transactionHistoryFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="audittrails" fileName="#{schoolBean.transactionHistoryFileName}"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="audittrails" fileName="#{schoolBean.transactionHistoryFileName}" />  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="audittrails" fileName="#{schoolBean.transactionHistoryFileName}" />  
                                </h:commandLink>  
                            </p:panel>  

                            <p:panel header="Export Page Data">  
                                <h:commandLink>  
                                    <p:graphicImage value="/images/excel.png" />  
                                    <p:dataExporter type="xls" target="audittrails" fileName="#{schoolBean.transactionHistoryFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/pdf.png" />  
                                    <p:dataExporter type="pdf" target="audittrails" fileName="#{schoolBean.transactionHistoryFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/csv.png" />  
                                    <p:dataExporter type="csv" target="audittrails" fileName="#{schoolBean.transactionHistoryFileName}" pageOnly="true"/>  
                                </h:commandLink>  

                                <h:commandLink>  
                                    <p:graphicImage value="/images/xml.png" />  
                                    <p:dataExporter type="xml" target="audittrails" fileName="#{schoolBean.transactionHistoryFileName}" pageOnly="true"/>  
                                </h:commandLink>  
                            </p:panel>  
                        </h:panelGrid> 
                        <br/>
                        <p:dataTable paginator="true" rows="20" rowsPerPageTemplate="5,10,15,50,100" styleClass="elevens datatables" value="#{schoolBean.auditTrails}" var="auditTrail" id="audittrails">
                            <f:facet name="header">Audit Trail</f:facet>
                            <p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Originator Name" />  
                                </f:facet>  
                                <h:outputText value="#{auditTrail.originatorName}" />  
                            </p:column> <p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Action Performed" />  
                                </f:facet>  
                                <h:outputText value="#{auditTrail.actionPerformed}" />  
                            </p:column> <p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Description" />  
                                </f:facet>  
                                <h:outputText value="#{auditTrail.description}}" />  
                            </p:column> <p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Originating IP Address" />  
                                </f:facet>  
                                <h:outputText value="#{auditTrail.originatorIpAddress}" />  
                            </p:column> <p:column>  
                                <f:facet name="header">  
                                    <h:outputText value="Date" />  
                                </f:facet>  
                                <h:outputText value="#{auditTrail.dateCreated}" />  
                            </p:column>           
                        </p:dataTable>                    
                    </h:form>
                </p:tab>      
            </p:tabView>
        </div>
    </h:body>
</html>